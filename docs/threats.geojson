{
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "properties": { "name": "Moscow – Ransomware", "count": 12 },
      "geometry": { "type": "Point", "coordinates": [37.6, 55.7] }
    },
    {
      "type": "Feature",
      "properties": { "name": "Berlin – Phishing", "count": 7 },
      "geometry": { "type": "Point", "coordinates": [13.4, 52.5] }
    },
    {
      "type": "Feature",
      "properties": { "name": "London", "count": 5000 },
      "geometry": { "type": "Point", "coordinates": [-0.09, 51.5] }
    },
    {
      "type": "Feature",
      "properties": { "name": "New York", "count": 3000 },
      "geometry": { "type": "Point", "coordinates": [-74.0, 40.7] }
    },
    {
      "type": "Feature",
      "properties": { "name": "Tokyo", "count": 4000 },
      "geometry": { "type": "Point", "coordinates": [139.7, 35.7] }
    }
  ]
}
const map     = L.map('map').setView([20, 0], 2);
const markers = L.markerClusterGroup();
// 3) добавяне на статични:
staticPoints.forEach(p => {
  L.marker(p.coords)
   .bindPopup(`<strong>${p.popup}</strong>`)
   .addTo(markers);
});

// 4) зареждаме GeoJSON
fetch('threats.geojson')
  .then(res => res.json())
  .then(data => {
    L.geoJSON(data, {
      onEachFeature: (feature, layer) => {
        if (feature.properties?.name) {
          layer.bindPopup(
            `<strong>${feature.properties.name}</strong><br>` +
            `Count: ${feature.properties.count}`
          );
        }
      }
    }).addTo(markers);

    // ➡️ след като са заредени *всички* маркери, правим fitBounds
    map.fitBounds(markers.getBounds(), { padding: [50, 50] });
  });
